<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-blog" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Essential modules for developing applications with FastAPI (P4 - Job Scheduler) | Immersed in Code</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://immersedincode.io.vn/blog/essential-modules-for-developing-applications-with-fastapi-p4-job-scheduler"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Essential modules for developing applications with FastAPI (P4 - Job Scheduler) | Immersed in Code"><meta data-rh="true" name="description" content="Welcome back!"><meta data-rh="true" property="og:description" content="Welcome back!"><meta data-rh="true" property="og:image" content="https://immersedincode.io.vn/img/02_essential-modules-for-developing-applications-with-fastapi-p1/featured.png"><meta data-rh="true" name="twitter:image" content="https://immersedincode.io.vn/img/02_essential-modules-for-developing-applications-with-fastapi-p1/featured.png"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-07-28T10:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/pxuanbach"><meta data-rh="true" property="article:tag" content="fastapi,apscheduler,job-scheduler,python,essential-modules-fastapi"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://immersedincode.io.vn/blog/essential-modules-for-developing-applications-with-fastapi-p4-job-scheduler"><link data-rh="true" rel="alternate" href="https://immersedincode.io.vn/blog/essential-modules-for-developing-applications-with-fastapi-p4-job-scheduler" hreflang="en"><link data-rh="true" rel="alternate" href="https://immersedincode.io.vn/blog/essential-modules-for-developing-applications-with-fastapi-p4-job-scheduler" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://immersedincode.io.vn/blog/essential-modules-for-developing-applications-with-fastapi-p4-job-scheduler","mainEntityOfPage":"https://immersedincode.io.vn/blog/essential-modules-for-developing-applications-with-fastapi-p4-job-scheduler","url":"https://immersedincode.io.vn/blog/essential-modules-for-developing-applications-with-fastapi-p4-job-scheduler","headline":"Essential modules for developing applications with FastAPI (P4 - Job Scheduler)","name":"Essential modules for developing applications with FastAPI (P4 - Job Scheduler)","description":"Welcome back!","datePublished":"2024-07-28T10:00:00.000Z","author":{"@type":"Person","name":"Bach Pham","description":"Software Engineer","url":"https://github.com/pxuanbach","image":"https://avatars.githubusercontent.com/u/55500268?v=4"},"image":{"@type":"ImageObject","@id":"https://immersedincode.io.vn/img/02_essential-modules-for-developing-applications-with-fastapi-p1/featured.png","url":"https://immersedincode.io.vn/img/02_essential-modules-for-developing-applications-with-fastapi-p1/featured.png","contentUrl":"https://immersedincode.io.vn/img/02_essential-modules-for-developing-applications-with-fastapi-p1/featured.png","caption":"title image for the blog post: Essential modules for developing applications with FastAPI (P4 - Job Scheduler)"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://immersedincode.io.vn/blog","name":"My Awesome Blog"}}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2VH0PJCNSH"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2VH0PJCNSH",{anonymize_ip:!0})</script>




<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Immersed in Code RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Immersed in Code Atom Feed"><link rel="stylesheet" href="/assets/css/styles.e64f082f.css">
<script src="/assets/js/runtime~main.fdfecc80.js" defer="defer"></script>
<script src="/assets/js/main.7abbe558.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Immersed in Code Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="Immersed in Code Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Immersed in Code</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/pxuanbach" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">My GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/essential-modules-for-developing-applications-with-fastapi-p6-monitoring">Essential modules for developing applications with FastAPI (P6 - Monitoring)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/essential-modules-for-developing-applications-with-fastapi-p5-rate-limiting">Essential modules for developing applications with FastAPI (P5 - Rate-limiting)</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/essential-modules-for-developing-applications-with-fastapi-p4-job-scheduler">Essential modules for developing applications with FastAPI (P4 - Job Scheduler)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/asynchronous-request-batching-design-pattern-in-nodejs">Asynchronous Request Batching Design Pattern in Node.js</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/destructuring-in-python">Destructuring in Python</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/essential-modules-for-developing-applications-with-fastapi-p3-caching">Essential modules for developing applications with FastAPI (P3 - Caching)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/dockerizing-medusajs-for-optimized-deployment">Dockerize MedusaJS Components: Optimize and Deploy Your Application</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/essential-modules-for-developing-applications-with-fastapi-p2-logging">Essential modules for developing applications with FastAPI (P2 - Logging)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/essential-modules-for-developing-applications-with-fastapi-p1-migration">Essential modules for developing applications with FastAPI (P1 - Migration)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/zero-downtime-deployment-with-docker-compose-nginx">Zero-downtime Deployments with Docker Compose &amp; Nginx</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/welcome">Welcome</a></li></ul></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Essential modules for developing applications with FastAPI (P4 - Job Scheduler)</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-07-28T10:00:00.000Z">July 28, 2024</time> · <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/pxuanbach" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/55500268?v=4" alt="Bach Pham"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/pxuanbach" target="_blank" rel="noopener noreferrer"><span>Bach Pham</span></a></div><small class="avatar__subtitle">Software Engineer</small></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Welcome back!</p>
<p>In part 4 of our series, we delve deeper into essential tools that streamline development and enhance functionality. Let&#x27;s dive in!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="frameworklibrary-version">Framework/Library version<a href="#frameworklibrary-version" class="hash-link" aria-label="Direct link to Framework/Library version" title="Direct link to Framework/Library version">​</a></h2>
<p>This project uses <a href="https://www.python.org/" target="_blank" rel="noopener noreferrer">Python</a> 3.10 as the environment and <a href="https://python-poetry.org/" target="_blank" rel="noopener noreferrer">Poetry</a> as the package manager.</p>
<p>The code and examples in this post will use frameworks/libraries with the following versions.</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockTitle_Ktv7">./pyproject.toml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">[tool.poetry.dependencies]</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">python = &quot;^3.10&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">uvicorn = {extras = [&quot;standard&quot;], version = &quot;^0.24.0.post1&quot;}</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">fastapi = &quot;^0.109.1&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">python-multipart = &quot;^0.0.7&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">email-validator = &quot;^2.1.0.post1&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">passlib = {extras = [&quot;bcrypt&quot;], version = &quot;^1.7.4&quot;}</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">tenacity = &quot;^8.2.3&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pydantic = &quot;&gt;2.0&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">emails = &quot;^0.6&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">gunicorn = &quot;^21.2.0&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">jinja2 = &quot;^3.1.2&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">alembic = &quot;^1.12.1&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">python-jose = {extras = [&quot;cryptography&quot;], version = &quot;^3.3.0&quot;}</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">httpx = &quot;^0.25.1&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">psycopg = {extras = [&quot;binary&quot;], version = &quot;^3.1.13&quot;}</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sqlmodel = &quot;^0.0.16&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"># Pin bcrypt until passlib supports the latest</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bcrypt = &quot;4.0.1&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">pydantic-settings = &quot;^2.2.1&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sentry-sdk = {extras = [&quot;fastapi&quot;], version = &quot;^1.40.6&quot;}</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">psycopg2 = &quot;^2.9.9&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">asyncpg = &quot;^0.29.0&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">redis = {extras = [&quot;hiredis&quot;], version = &quot;^5.0.3&quot;}</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">orjson = &quot;^3.10.0&quot;</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">apscheduler = &quot;^3.10.4&quot;</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="job-scheduler">Job Scheduler<a href="#job-scheduler" class="hash-link" aria-label="Direct link to Job Scheduler" title="Direct link to Job Scheduler">​</a></h2>
<p>In the real world, the Job Scheduler module stands out as a fundamental tool for automating tasks and managing scheduled activities within web applications. FastAPI, with its asynchronous capabilities, integrates seamlessly with Job Scheduler modules, allowing efficient automation of recurring tasks.</p>
<p>I will introduce a library that I am using to build this module for my applications. It offers many options, powerful features, and operates flexibly.</p>
<p>It&#x27;s <a href="https://github.com/agronholm/apscheduler" target="_blank" rel="noopener noreferrer">APScheduler</a> (6k stars, 693 forks on 28/07/2024). If you are wondering why, the answer comes from a ticket in my job, which required adding a feature to schedule certain tasks during the day in the FastAPI application. Then, I wandered through various blogs, forums, and stopped at a <a href="https://github.com/tiangolo/fastapi/discussions/9143" target="_blank" rel="noopener noreferrer">discussion</a> in the FastAPI repository. Many libraries were mentioned, and then I stopped <a href="https://github.com/tiangolo/fastapi/discussions/9143#discussioncomment-5157569" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>This library supports job storage with SQLAlchemy (<code>SQLAlchemyJobStore</code>) and job scheduling with asyncio (<code>AsyncIOScheduler</code>).</p>
<p>This library has three built-in scheduling systems</p>
<ul>
<li>Cron-style scheduling (with optional start/end times)</li>
<li>Interval-based execution (runs jobs on even intervals, with optional start/end times)</li>
<li>One-off delayed execution (runs jobs once, on a set date/time)</li>
</ul>
<p>So, we can organize the module flexibly to take advantage of those benefits.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install">Install<a href="#install" class="hash-link" aria-label="Direct link to Install" title="Direct link to Install">​</a></h3>
<p>First, we should install the APScheduler package.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">poetry add apscheduler   # pip install apscheduler</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prepare-before-coding">Prepare before coding<a href="#prepare-before-coding" class="hash-link" aria-label="Direct link to Prepare before coding" title="Direct link to Prepare before coding">​</a></h3>
<p>Because APScheduler provides flexibility in adding and removing jobs at runtime, I usually build it as a regular entity in the system. That means there will be APIs performing CRD operations for it (no need for U - Update, because we only need to delete and re-add that job back into the system).</p>
<p>We will have a separate database to store jobs, typically I will use SQLite or PostgreSQL. It&#x27;s lightweight and compatible with SQLAlchemy (<code>SQLAlchemyJobStore</code>).</p>
<p>In practice, I almost exclusively work with tasks that use <code>cron</code> or <code>interval</code> triggers. I rarely use <code>date</code>. However, for the sake of completeness in this article, I will also write APIs to support it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-scheduler-instance">Create a Scheduler instance<a href="#create-a-scheduler-instance" class="hash-link" aria-label="Direct link to Create a Scheduler instance" title="Direct link to Create a Scheduler instance">​</a></h3>
<p>In the first steps, we just need to declare an instance representing the Scheduler.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockTitle_Ktv7">./app/core/scheduler.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> apscheduler</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">schedulers</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">asyncio </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> AsyncIOScheduler</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> apscheduler</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">jobstores</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">sqlalchemy </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> SQLAlchemyJobStore</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> app</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">config </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> settings</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">jobstores </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&#x27;default&#x27;</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> SQLAlchemyJobStore</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">url</span><span class="token operator" style="color:#475569">=</span><span class="token plain">settings</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">JOB_DATABASE_URI</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">scheduler </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> AsyncIOScheduler</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">jobstores</span><span class="token operator" style="color:#475569">=</span><span class="token plain">jobstores</span><span class="token punctuation" style="color:#475569">)</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="integration-with-fastapi">Integration with FastAPI<a href="#integration-with-fastapi" class="hash-link" aria-label="Direct link to Integration with FastAPI" title="Direct link to Integration with FastAPI">​</a></h3>
<p>We also use the lifespan function to manage the lifecycle of the scheduler instance.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockTitle_Ktv7">./app/main.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> fastapi </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> FastAPI</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> contextlib </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> asynccontextmanager</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> app</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">scheduler </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> scheduler</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#475569">@asynccontextmanager</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">def</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">lifespan</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> FastAPI</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#6A9955"># start up</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">try</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        scheduler</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">start</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#0c4a6e">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain">    </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        logging</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;Unable to Create Schedule Object - [%s]&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain">   </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">yield</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#6A9955"># shut down</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    scheduler</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">shutdown</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">app </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> FastAPI</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    title</span><span class="token operator" style="color:#475569">=</span><span class="token plain">settings</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">PROJECT_NAME</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    lifespan</span><span class="token operator" style="color:#475569">=</span><span class="token plain">lifespan</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#475569">)</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When running the project, you will see the log printed on the console as follows:</p>
<p><img decoding="async" loading="lazy" alt="Startup Log" src="/assets/images/start-up-log-6516261ca84dd3198a132fa4c391e1b4.png" width="708" height="156" class="img_ev3q"></p>
<p>This is just the warm-up part, now let&#x27;s move on to the main part.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="build-job-creation-api">Build Job Creation API<a href="#build-job-creation-api" class="hash-link" aria-label="Direct link to Build Job Creation API" title="Direct link to Build Job Creation API">​</a></h3>
<p>First of all, initialize an APIRouter instance and register it in the FastAPI application.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockTitle_Ktv7">./app/api/jobs.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> logging</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> fastapi </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> APIRouter</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> HTTPException</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> Request</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> BackgroundTasks</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> status</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">router </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> APIRouter</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">prefix</span><span class="token operator" style="color:#475569">=</span><span class="token string" style="color:#64748b">&quot;/jobs&quot;</span><span class="token punctuation" style="color:#475569">)</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockTitle_Ktv7">./app/api/__init__.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> fastapi </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> APIRouter</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> app</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">api </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> user</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> utils</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> jobs</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#475569">.</span><span class="token punctuation" style="color:#475569">.</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">router</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">include_router</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">jobs</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">router</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> tags</span><span class="token operator" style="color:#475569">=</span><span class="token punctuation" style="color:#475569">[</span><span class="token string" style="color:#64748b">&quot;Job&quot;</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">)</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, let&#x27;s talk about the interesting things about job creation API. As mentioned above, we will create an API to be able to create a new job while the application is running.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="schemamodel">Schema/Model<a href="#schemamodel" class="hash-link" aria-label="Direct link to Schema/Model" title="Direct link to Schema/Model">​</a></h4>
<p>The payload schema would look as follows:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockTitle_Ktv7">./app/models/job.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> datetime </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> datetime</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> typing </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> List</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> Literal</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> Union</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> sqlmodel </span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> SQLModel</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">CronArgs</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">SQLModel</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    year</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;*&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    month</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;*&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    day</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;*&quot;</span><span class="token plain"> </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    week</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;*&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    day_of_week</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;*&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    hour</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;*&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    minute</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;*&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    second</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;5&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IntervalArgs</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">SQLModel</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    seconds</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">int</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">10</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    minutes</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">int</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    hours</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">int</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    days</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">int</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    weeks</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token builtin" style="color:#0c4a6e">int</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">DateArgs</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">SQLModel</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    args</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#475569">[</span><span class="token plain">Any</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    run_date</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> datetime </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">now</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">JobCreate</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">SQLModel</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    job_id</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    from_file</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">bool</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token boolean">True</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token builtin" style="color:#0c4a6e">type</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Literal</span><span class="token punctuation" style="color:#475569">[</span><span class="token string" style="color:#64748b">&#x27;cron&#x27;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&#x27;interval&#x27;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&#x27;date&#x27;</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&#x27;cron&#x27;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    args</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#475569">[</span><span class="token plain">Union</span><span class="token punctuation" style="color:#475569">[</span><span class="token plain">DateArgs</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> IntervalArgs</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> CronArgs</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token boolean">None</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the API can create all 3 types of jobs simultaneously, so I designed it as above. However, it might be beneficial to decouple these functionalities for improved maintainability and extensibility.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="api-logic">API Logic<a href="#api-logic" class="hash-link" aria-label="Direct link to API Logic" title="Direct link to API Logic">​</a></h4>
<p>Next, let&#x27;s take a quick look at this code snippet.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockTitle_Ktv7">./app/api/jobs.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token decorator annotation punctuation" style="color:#475569">@router</span><span class="token decorator annotation punctuation" style="color:#475569">.</span><span class="token decorator annotation punctuation" style="color:#475569">post</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> response_model</span><span class="token operator" style="color:#475569">=</span><span class="token plain">JobCreateDeleteResponse</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">def</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">add_job_to_scheduler</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">obj_in</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> JobCreate</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token operator" style="color:#475569">-</span><span class="token operator" style="color:#475569">&gt;</span><span class="token plain"> JobCreateDeleteResponse</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#6A9955"># Find job folder</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    job_folder </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> path</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;app&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> settings</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">JOB_DIR</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> obj_in</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">job_id</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">not</span><span class="token plain"> path</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">exists</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">job_folder</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">raise</span><span class="token plain"> HTTPException</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">status_code</span><span class="token operator" style="color:#475569">=</span><span class="token plain">status</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">HTTP_404_NOT_FOUND</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> detail</span><span class="token operator" style="color:#475569">=</span><span class="token string" style="color:#64748b">&quot;Job folder not found.&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    _timers </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> obj_in</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">args</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#6A9955"># Get timer parameters if `.schedule` file exists</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> obj_in</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">from_file</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        _timers </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        _sched_path </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> path</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">job_folder</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;.schedule&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">not</span><span class="token plain"> path</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">exists</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">_sched_path</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">raise</span><span class="token plain"> HTTPException</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">status_code</span><span class="token operator" style="color:#475569">=</span><span class="token plain">status</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">HTTP_404_NOT_FOUND</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> detail</span><span class="token operator" style="color:#475569">=</span><span class="token string" style="color:#64748b">&quot;Schedule file not found&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:#6A9955"># read parameters from `.schedule` file</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        sched </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> read_file_line_by_line</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">_sched_path</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#0c4a6e">in</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">range</span><span class="token punctuation" style="color:#475569">(</span><span class="token builtin" style="color:#0c4a6e">len</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">sched</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> i </span><span class="token operator" style="color:#475569">==</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">0</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">or</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">sched</span><span class="token punctuation" style="color:#475569">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&#x27;#&#x27;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">or</span><span class="token plain"> sched</span><span class="token punctuation" style="color:#475569">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">==</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&#x27;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">or</span><span class="token plain"> sched</span><span class="token punctuation" style="color:#475569">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">is</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                </span><span class="token keyword" style="color:#0c4a6e">continue</span><span class="token plain"> </span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            _interval_timer </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">sched</span><span class="token punctuation" style="color:#475569">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;=&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            _timers</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">update</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain">_interval_timer</span><span class="token punctuation" style="color:#475569">[</span><span class="token number" style="color:#B5CEA8">0</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> _interval_timer</span><span class="token punctuation" style="color:#475569">[</span><span class="token number" style="color:#B5CEA8">1</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#6A9955"># Get cron-job timer parameters if type equals &quot;cron&quot;</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> obj_in</span><span class="token punctuation" style="color:#475569">.</span><span class="token builtin" style="color:#0c4a6e">type</span><span class="token plain"> </span><span class="token operator" style="color:#475569">==</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;cron&quot;</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        _timers </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> CronArgs</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">model_validate</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">_timers</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#6A9955"># Get interval-job timer parameters if type equals &quot;interval&quot;</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">elif</span><span class="token plain"> obj_in</span><span class="token punctuation" style="color:#475569">.</span><span class="token builtin" style="color:#0c4a6e">type</span><span class="token plain"> </span><span class="token operator" style="color:#475569">==</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;interval&quot;</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        _timers </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> IntervalArgs</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">model_validate</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">_timers</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#6A9955"># Get date-off job timer parameters if type equals &quot;date&quot;</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">elif</span><span class="token plain"> obj_in</span><span class="token punctuation" style="color:#475569">.</span><span class="token builtin" style="color:#0c4a6e">type</span><span class="token plain"> </span><span class="token operator" style="color:#475569">==</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;date&quot;</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        _timers </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> DateArgs</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">model_validate</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">_timers</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#6A9955"># find job module in `./app/jobs` folder, </span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#6A9955"># register the `call` function inside the module to the scheduler with timer parameters</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    _job_module </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> importlib</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">import_module</span><span class="token punctuation" style="color:#475569">(</span><span class="token string-interpolation string" style="color:#64748b">f&quot;app.jobs.</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">{</span><span class="token string-interpolation interpolation">obj_in</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">.</span><span class="token string-interpolation interpolation">job_id</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">}</span><span class="token string-interpolation string" style="color:#64748b">.main&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">try</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        job </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> scheduler</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">add_job</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            _job_module</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">call</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            obj_in</span><span class="token punctuation" style="color:#475569">.</span><span class="token builtin" style="color:#0c4a6e">type</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token builtin" style="color:#0c4a6e">id</span><span class="token operator" style="color:#475569">=</span><span class="token plain">obj_in</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">job_id</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token operator" style="color:#475569">**</span><span class="token plain">_timers</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">model_dump</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">exclude_none</span><span class="token operator" style="color:#475569">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">except</span><span class="token plain"> ConflictingIdError</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        logging</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">warning</span><span class="token punctuation" style="color:#475569">(</span><span class="token string-interpolation string" style="color:#64748b">f&quot;Job </span><span class="token string-interpolation interpolation punctuation" style="color:#475569">{</span><span class="token string-interpolation interpolation">obj_in</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">.</span><span class="token string-interpolation interpolation">job_id</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">}</span><span class="token string-interpolation string" style="color:#64748b"> already exists&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">raise</span><span class="token plain"> HTTPException</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">status_code</span><span class="token operator" style="color:#475569">=</span><span class="token plain">status</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">HTTP_409_CONFLICT</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> detail</span><span class="token operator" style="color:#475569">=</span><span class="token string" style="color:#64748b">&quot;Job already exists&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#0c4a6e">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        logging</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#475569">(</span><span class="token string-interpolation string" style="color:#64748b">f&quot;Add job </span><span class="token string-interpolation interpolation punctuation" style="color:#475569">{</span><span class="token string-interpolation interpolation">obj_in</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">.</span><span class="token string-interpolation interpolation">job_id</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">}</span><span class="token string-interpolation string" style="color:#64748b"> - </span><span class="token string-interpolation interpolation punctuation" style="color:#475569">{</span><span class="token string-interpolation interpolation builtin" style="color:#0c4a6e">str</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">(</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">)</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">}</span><span class="token string-interpolation string" style="color:#64748b">&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">raise</span><span class="token plain"> HTTPException</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">status_code</span><span class="token operator" style="color:#475569">=</span><span class="token plain">status</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">HTTP_400_BAD_REQUEST</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> detail</span><span class="token operator" style="color:#475569">=</span><span class="token string" style="color:#64748b">&quot;An error occurred&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> JobCreateDeleteResponse</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">scheduled</span><span class="token operator" style="color:#475569">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> job_id</span><span class="token operator" style="color:#475569">=</span><span class="token plain">job</span><span class="token punctuation" style="color:#475569">.</span><span class="token builtin" style="color:#0c4a6e">id</span><span class="token punctuation" style="color:#475569">)</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>How does it work?</p>
<ol>
<li>
<p>From line <strong>4-6</strong>, to register a job, we must define the job into <code>./app/jobs</code> folder. The name of the job folder must be equal to the <code>job_id</code>. For example:</p>
<p><img decoding="async" loading="lazy" alt="Define Job in Jobs folder" src="/assets/images/define-job-in-jobs-folder-3ae89d2adb8e139035efb7b2c5808aa4.png" width="793" height="512" class="img_ev3q"></p>
</li>
<li>
<p>From line <strong>10-31</strong>, I provide 2 options to create a new job.</p>
<ol>
<li>Register with <code>.schedule</code> file, this file will be placed in the job folder.</li>
<li>Register via API payload (Schema/Model) that I mentioned above.</li>
</ol>
</li>
<li>
<p>In line <strong>35</strong>, import the module dynamically using <code>job_id</code> via the <code>importlib</code> library.</p>
</li>
<li>
<p>From line <strong>37-42</strong>, try to register the job into the scheduler&#x27;s job store.</p>
</li>
</ol>
<p>We will test it later. Next I will introduce the Get all jobs API.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-all-jobs-api">Get All Jobs API<a href="#get-all-jobs-api" class="hash-link" aria-label="Direct link to Get All Jobs API" title="Direct link to Get All Jobs API">​</a></h3>
<p>This API is simpler than Job Creation API.</p>
<p>The code will look like this:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockTitle_Ktv7">./app/api/jobs.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token decorator annotation punctuation" style="color:#475569">@router</span><span class="token decorator annotation punctuation" style="color:#475569">.</span><span class="token decorator annotation punctuation" style="color:#475569">get</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">def</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">get_scheduled_jobs</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    schedules </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">for</span><span class="token plain"> job </span><span class="token keyword" style="color:#0c4a6e">in</span><span class="token plain"> scheduler</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">get_jobs</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        schedules</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token string" style="color:#64748b">&quot;job_id&quot;</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">job</span><span class="token punctuation" style="color:#475569">.</span><span class="token builtin" style="color:#0c4a6e">id</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token string" style="color:#64748b">&quot;run_frequency&quot;</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">job</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">trigger</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token string" style="color:#64748b">&quot;next_run&quot;</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">job</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">next_run_time</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;total&quot;</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">len</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">schedules</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;jobs&quot;</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> schedules </span><span class="token punctuation" style="color:#475569">}</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>How does it work?</p>
<ol>
<li>It uses APScheduler’s <code>get_jobs</code> API to get all registered jobs.</li>
<li>Loop through all jobs to retrieve the necessary data.</li>
<li>Returns total number of registered jobs and job information.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="delete-job-api">Delete Job API<a href="#delete-job-api" class="hash-link" aria-label="Direct link to Delete Job API" title="Direct link to Delete Job API">​</a></h3>
<p>Using the <code>job_id</code> as a unique identifier, we will invoke the APScheduler’s <code>remove_job</code> API to delete the corresponding job from the job store.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockTitle_Ktv7">./app/api/jobs.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token decorator annotation punctuation" style="color:#475569">@router</span><span class="token decorator annotation punctuation" style="color:#475569">.</span><span class="token decorator annotation punctuation" style="color:#475569">delete</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;/{job_id}&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> response_model</span><span class="token operator" style="color:#475569">=</span><span class="token plain">JobCreateDeleteResponse</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">def</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">remove_job_from_scheduler</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">job_id</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">str</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token operator" style="color:#475569">-</span><span class="token operator" style="color:#475569">&gt;</span><span class="token plain"> JobCreateDeleteResponse</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">try</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        scheduler</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">remove_job</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">job_id</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#0c4a6e">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        logging</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#475569">(</span><span class="token string-interpolation string" style="color:#64748b">f&quot;Delete job </span><span class="token string-interpolation interpolation punctuation" style="color:#475569">{</span><span class="token string-interpolation interpolation">job_id</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">}</span><span class="token string-interpolation string" style="color:#64748b"> - </span><span class="token string-interpolation interpolation punctuation" style="color:#475569">{</span><span class="token string-interpolation interpolation builtin" style="color:#0c4a6e">str</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">(</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">)</span><span class="token string-interpolation interpolation punctuation" style="color:#475569">}</span><span class="token string-interpolation string" style="color:#64748b">&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">raise</span><span class="token plain"> HTTPException</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">status_code</span><span class="token operator" style="color:#475569">=</span><span class="token plain">status</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">HTTP_400_BAD_REQUEST</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> mdetail</span><span class="token operator" style="color:#475569">=</span><span class="token string" style="color:#64748b">&quot;Job deleted failed&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> JobCreateDeleteResponse</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">scheduled</span><span class="token operator" style="color:#475569">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> job_id</span><span class="token operator" style="color:#475569">=</span><span class="token plain">job_id</span><span class="token punctuation" style="color:#475569">)</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-see-the-results">Let&#x27;s see the results<a href="#lets-see-the-results" class="hash-link" aria-label="Direct link to Let&#x27;s see the results" title="Direct link to Let&#x27;s see the results">​</a></h2>
<p>I created some scripts in <code>./tests</code> folder for testing.</p>
<p>For instance, a script will look like:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockTitle_Ktv7">./tests/job_scheduler/get_list_jobs.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> requests</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">url </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;http://localhost:8000/api/v1/jobs&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">payload </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">headers </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#64748b">&quot;Content-Type&quot;</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;application/json&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">response </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;GET&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> url</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> data</span><span class="token operator" style="color:#475569">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> headers</span><span class="token operator" style="color:#475569">=</span><span class="token plain">headers</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#0f172a"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">print</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#475569">)</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Let&#x27;s see how our job scheduler looks like.</p>
<p><img decoding="async" loading="lazy" alt="Test Create A New Cron-job" src="/assets/images/test-create-cron-job-f119bb8ad0592714b93e96b809bfb9fb.png" width="1388" height="428" class="img_ev3q"></p>
<p>First, I create a cron-job and look at the logs. As you can see, the job has been successfully registered in the job store and runs every 10 seconds.</p>
<p>Now, delete it using the <code>delete_job.py</code> script and create an interval job.</p>
<p><img decoding="async" loading="lazy" alt="Test Delete, Create A New Interval Job, Get Jobs" src="/assets/images/test-delete-create-get-jobs-45470fa5a5cad132893fa0c9ec57b85f.png" width="1406" height="407" class="img_ev3q"></p>
<p>Wow, it’s work. Then test the Get all jobs API using <code>get_list_jobs.py</code> script. We can see it prints to the console that we have a total of 1 job in the job store.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="notes">Notes<a href="#notes" class="hash-link" aria-label="Direct link to Notes" title="Direct link to Notes">​</a></h2>
<p>In addition to the benefits it brings, we also need to pay attention to a few other things:</p>
<ul>
<li>The use of an in-app scheduler can lead to higher resource consumption by the application, and it generates a larger amount of logs, which can make error tracking more challenging. To address this issue, you can separate it into a dedicated application specifically for executing scheduled jobs. Your main application can call the job scheduler app via HTTP, GRPC, etc., to register jobs into the job store.</li>
<li>Beyond <code>AsyncIOScheduler</code>, APScheduler offers a variety of job schedulers and storage options. Explore the documentation to select the optimal tool for your system. <a href="https://apscheduler.readthedocs.io/en/3.x/userguide.html#choosing-the-right-scheduler-job-store-s-executor-s-and-trigger-s" target="_blank" rel="noopener noreferrer">https://apscheduler.readthedocs.io/en/3.x/userguide.html#choosing-the-right-scheduler-job-store-s-executor-s-and-trigger-s</a></li>
<li>To avoid your scheduler consuming a lot of database connections, try to limit the number of concurrent executions. <a href="https://apscheduler.readthedocs.io/en/3.x/userguide.html#limiting-the-number-of-concurrently-executing-instances-of-a-job" target="_blank" rel="noopener noreferrer">https://apscheduler.readthedocs.io/en/3.x/userguide.html#limiting-the-number-of-concurrently-executing-instances-of-a-job</a></li>
</ul>
<p>Some packages that you may be interested in:</p>
<ul>
<li><a href="https://github.com/celery/celery" target="_blank" rel="noopener noreferrer">celery/celery: Distributed Task Queue (development branch) (github.com)</a> (24.2k stars, 4.6k forks on 28/07/2024)</li>
<li><a href="https://github.com/samuelcolvin/arq" target="_blank" rel="noopener noreferrer">samuelcolvin/arq (github.com)</a> (2k stars, 170 forks on 28/07/2024) - <em>The author is the creator of <a href="https://github.com/pydantic/pydantic" target="_blank" rel="noopener noreferrer">Pydantic</a>, an important module integrated with FastAPI.</em></li>
<li><a href="https://github.com/dmontagu/fastapi-utils" target="_blank" rel="noopener noreferrer">dmontagu/fastapi-utils (github.com)</a> (1.8k stars, 163 forks on 28/07/2024)</li>
<li><a href="https://github.com/aio-libs/aiojobs" target="_blank" rel="noopener noreferrer">aio-libs/aiojobs (github.com)</a> (821 stars, 66 forks on 28/07/2024)</li>
<li><a href="https://github.com/madkote/fastapi-plugins" target="_blank" rel="noopener noreferrer">madkote/fastapi-plugins (github.com)</a> (355 stars, 19 forks on 28/07/2024)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>I hope this post was useful. If you need a project to run a demo on your environment, here is my <a href="https://github.com/pxuanbach/fastapi-essential-modules" target="_blank" rel="noopener noreferrer">Git repository</a>.</p>
<p>Have a great weekend!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<ul>
<li><a href="https://apscheduler.readthedocs.io/en/3.x/userguide.html" target="_blank" rel="noopener noreferrer">https://apscheduler.readthedocs.io/en/3.x/userguide.html</a></li>
<li><a href="https://github.com/tiangolo/fastapi/discussions/9143" target="_blank" rel="noopener noreferrer">how can i run scheduling tasks using fastapi&#x27;s · tiangolo/fastapi · Discussion #9143 (github.com)</a></li>
</ul></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/fastapi">fastapi</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/apscheduler">apscheduler</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/job-scheduler">job-scheduler</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/python">python</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/essential-modules-fastapi">essential-modules-fastapi</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/essential-modules-for-developing-applications-with-fastapi-p5-rate-limiting"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Essential modules for developing applications with FastAPI (P5 - Rate-limiting)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/asynchronous-request-batching-design-pattern-in-nodejs"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Asynchronous Request Batching Design Pattern in Node.js</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#frameworklibrary-version" class="table-of-contents__link toc-highlight">Framework/Library version</a></li><li><a href="#job-scheduler" class="table-of-contents__link toc-highlight">Job Scheduler</a><ul><li><a href="#install" class="table-of-contents__link toc-highlight">Install</a></li><li><a href="#prepare-before-coding" class="table-of-contents__link toc-highlight">Prepare before coding</a></li><li><a href="#create-a-scheduler-instance" class="table-of-contents__link toc-highlight">Create a Scheduler instance</a></li><li><a href="#integration-with-fastapi" class="table-of-contents__link toc-highlight">Integration with FastAPI</a></li><li><a href="#build-job-creation-api" class="table-of-contents__link toc-highlight">Build Job Creation API</a></li><li><a href="#get-all-jobs-api" class="table-of-contents__link toc-highlight">Get All Jobs API</a></li><li><a href="#delete-job-api" class="table-of-contents__link toc-highlight">Delete Job API</a></li></ul></li><li><a href="#lets-see-the-results" class="table-of-contents__link toc-highlight">Let&#39;s see the results</a></li><li><a href="#notes" class="table-of-contents__link toc-highlight">Notes</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ImmersedinCode Blog</div><ul class="footer__items clean-list"><li class="footer__item"><p>Simplicity is the soul of efficiency.</p></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/pxuanbach" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:pxuanbach1412@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gmail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/pham-bach-97a389217/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/about">About</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Bach Pham, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>